function loadInitialEpub(e){function t(){console.log(navigator.epubReadingSystem)}e(document).ready(function(){ReadiumApp.viewerPreferences={fontSize:12,syntheticLayout:!0,tocVisible:!0,libraryIsVisible:!1,tocIsVisible:!0};var e="";if(parent.epub!==null&&parent.epub!==undefined)var e=parent.epub;ReadiumApp.loadAndRenderEpub(e)});document.addEventListener("DOMContentLoaded",function(e){setTimeout(t,200)},!1)}var pathsReadium={jquery:"jquery-1.9.1",underscore:"underscore-1.4.4",backbone:"backbone-0.9.10",Readium:"./readium-js/Readium"};require.config({baseUrl:"assets/",urlArgs:"bust="+(new Date).getTime(),shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"}},paths:pathsReadium});ReadiumApp={};require(["jquery","underscore","Readium"],function(e,t,n,r){ReadiumApp.setModuleContainerHeight=function(){e("#reader").css({height:e(window).height()*.85+"px"})};ReadiumApp.addTOC=function(e){};ReadiumApp.loadAndRenderEpub=function(t){var r=this;ReadiumApp.epubViewer=undefined;var i="assets/",s=e("#reader")[0];e(s).html("");ReadiumApp.readium=new n(s,t,i,function(t){ReadiumApp.epubViewer=t;ReadiumApp.epubViewer.openBook();ReadiumApp.addTOC(e("#toc-iframe")[0]);ReadiumApp.applyToolbarHandlers();ReadiumApp.setModuleContainerHeight()})};loadInitialEpub(e)});define(["jquery"],function(e){ReadiumApp.applyToolbarHandlers=function(){e("#toc-btn").off("click");e("#library-btn").on("click",function(){ReadiumApp.toggleLibraryPanel()});e("#toc-btn").off("click");e("#toc-btn").on("click",function(){ReadiumApp.toggleTOCPanel()});(function(){var t=e("#decrease-font-btn");t.off("click");t.on("click",function(){console.log("differential changes to fontSize not supported with the ReadiumSDK version used.")})})();(function(){var t=e("#increase-font-btn");t.off("click");t.on("click",function(){console.log("differential changes to fontSize not supported with the ReadiumSDK version used.")})})();e("#previous-page-btn").off("click");e("#previous-page-btn").on("click",function(e){ReadiumApp.epubViewer.openPageLeft();e.preventDefault()});e("#next-page-btn").off("click");e("#next-page-btn").on("click",function(e){ReadiumApp.epubViewer.openPageRight();e.preventDefault()});e("#toggle-synthetic-btn").off("click");e("#toggle-synthetic-btn").on("click",function(e){ReadiumApp.toggleLayout();e.preventDefault()})};ReadiumApp.epubLinkClicked=function(e){var t,n,r;e.preventDefault();e.currentTarget.attributes["xlink:href"]?t=e.currentTarget.attributes["xlink:href"].value:t=e.currentTarget.attributes.href.value;if(t.match("epubcfi")){t=t.trim();n=t.split("#")}else{t=t.trim();n=t.split("#");r=ReadiumApp.epub.getSpineIndexByHref(t);n[1]===undefined}};ReadiumApp.tocLinkClicked=function(e){ReadiumApp.epubLinkClicked(e)};ReadiumApp.toggleLibraryPanel=function(){if(ReadiumApp.viewerPreferences.libraryIsVisible){e("#library-panel").hide();ReadiumApp.viewerPreferences.libraryIsVisible=!1}else{e("#toc-panel").hide();e("#library-panel").show();ReadiumApp.viewerPreferences.tocIsVisible=!1;ReadiumApp.viewerPreferences.libraryIsVisible=!0}};ReadiumApp.toggleTOCPanel=function(){if(ReadiumApp.viewerPreferences.tocIsVisible){e("#toc-panel").hide();ReadiumApp.viewerPreferences.tocIsVisible=!1}else{e("#library-panel").hide();e("#toc-panel").show();ReadiumApp.viewerPreferences.tocIsVisible=!0;ReadiumApp.viewerPreferences.libraryIsVisible=!1}};ReadiumApp.toggleLayout=function(){if(ReadiumApp.viewerPreferences.syntheticLayout){ReadiumApp.epubViewer.updateSettings({isSyntheticSpread:!1});ReadiumApp.viewerPreferences.syntheticLayout=!1}else{ReadiumApp.epubViewer.updateSettings({isSyntheticSpread:!0});ReadiumApp.viewerPreferences.syntheticLayout=!0}};return ReadiumApp});